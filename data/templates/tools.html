{% extends "base.html" %}
{% import "inc/utils.html" as utils %}

{% block title %}{{ 'tools-title'|message }} - {{ parent() }}{% endblock %}

{% block nav_li_tools %}active{% endblock %}

{% block content %}
<ol class="breadcrumb">
  <li class="breadcrumb-item"><a href="{{ urlFor('splash') }}">{{ 'nav-home'|message }}</a></li>
  <li class="breadcrumb-item active">{{ 'nav-tools'|message }}</li>
</ol>

<h1>{{ 'tools-header'|message }}</h1>

<table id="thebigtable" class="table table-striped table-sm table-responsive">
  <thead>
    <tr>
      <th>Tool</th>
      <th>Maintainers</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    {% for tool in tools %}
    <tr class="tool" id="toollist-{{ tool.name }}">
      <td class="tool-name">
        {% if tool.toolinfo|length == 1 %}
        {% set info = tool.toolinfo[0] %}
        {% if info.url %}
        <a class="tool-web" href="{{ info.url }}">{{ tool.name }}</a>
        {% elseif active[tool.name] %}
        <a class="tool-web" href="/{{ tool.name }}/">{{ tool.name }}</a>
        {% else %}
        {{ tool.name }}
        {% endif %}
        {% else %}
        {{ tool.name }}
        {% endif %}
        <span class="mw-editsection">[<a href="https://toolsadmin.wikimedia.org/tools/id/{{ tool.name|url_encode }}/maintainers/">manage</a> maintainers]</span>
      </td>
      <td class="tool-maintainers">
        {% for maintainer in tool.maintainers %}
        {% if users[maintainer] %}
        {% set wiki_user = users[maintainer].wikitech %}
        <a href="https://wikitech.wikimedia.org/wiki/User:{{ utils.as_title(wiki_user)|url_encode }}">{{ utils.ucfirst(wiki_user) }}</a>
        {% endif %}
        {% endfor %}
      </td>
      <td class="tool-desc">
        {% if tool.toolinfo|length == 1 %}
        {{- utils.describe_tool(tool.toolinfo[0]) -}}
        {% else %}
        {% for info in tool.toolinfo %}
        <div class="subtool {% if loop.first %}first{% endif %}">
          <div class="subtool-name">
            {% if info.url %}
            <a href="{{ info.url }}">{{ info.title }}</a>
            {% else %}
            {{ info.title }}
            {% endif %}
          </div>
          <div class="subtool-desc">{{ utils.describe_tool(info) }}</div>
        </div>
        {% endfor %}
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock content %}
